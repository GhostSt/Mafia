server {
    listen 80;
    listen [::]:80;

	access_log /var/log/nginx/access.log;
	error_log /var/log/nginx/error.log;

	server_name mafia.yalta;
	root /code/web;
	set $yii_bootstrap "app.php";

	charset utf-8;

	client_max_body_size 0;

	location / {
		index  index.html $yii_bootstrap;
		try_files $uri $uri/ /$yii_bootstrap?$args;
	}

	location ~ ^/(protected|framework|themes/\w+/views) {
	}

	#avoid processing of calls to unexisting static files by yii
	location ~ \.(js|css|png|jpg|gif|swf|ico|pdf|mov|fla|zip|rar|txt)$ {
		sendfile off;
		try_files $uri =404;
		#For production servers you can set expires header with a long period
		#expires 3M;
	}
	location ~ \.php {
		fastcgi_split_path_info  ^(.+\.php)(.*)$;

		#let yii catch the calls to unexising PHP files
		set $fsn /$yii_bootstrap;
		if (-f $document_root$fastcgi_script_name){
			set $fsn $fastcgi_script_name;
		}

		fastcgi_pass php:9000;
		include fastcgi_params;

		fastcgi_param  SCRIPT_FILENAME  $document_root$fsn;

		#PATH_INFO and PATH_TRANSLATED can be omitted, but RFC 3875 specifies them for CGI
		fastcgi_param  PATH_INFO        $fastcgi_path_info;
		fastcgi_param  PATH_TRANSLATED  $document_root$fsn;
	}
}